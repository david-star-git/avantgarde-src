const categoryButtons=document.querySelectorAll(".category-btn");const galleryItems=document.querySelectorAll(".gallery-item");function layoutGallery(category){const container=document.querySelector(".gallery-grid");const gap=16;const itemWidth=220;const itemHeight=180;const containerWidth=container.clientWidth;const columns=Math.max(1,Math.floor((containerWidth+gap)/(itemWidth+gap)));const totalGridWidth=columns*itemWidth+(columns-1)*gap;const offsetX=(containerWidth-totalGridWidth)/2;const columnHeights=new Array(columns).fill(0);let visibleIndex=0;galleryItems.forEach((item)=>{const shouldShow=category==="alle"||item.dataset.category===category;if(!shouldShow){item.classList.add("hidden");return;}
item.classList.remove("hidden");const col=visibleIndex%columns;const x=offsetX+col*(itemWidth+gap);const y=columnHeights[col];item.style.transform=`translate(${x}px,${y}px)`;columnHeights[col]+=itemHeight+gap;visibleIndex++;});container.style.height=(columnHeights.length?Math.max(...columnHeights):0)+"px";}
categoryButtons.forEach((btn)=>{btn.addEventListener("click",()=>{categoryButtons.forEach((b)=>b.classList.remove("active"));btn.classList.add("active");layoutGallery(btn.dataset.category);});});window.addEventListener("resize",()=>layoutGallery(document.querySelector(".category-btn.active").dataset.category));layoutGallery("alle");const modal=document.getElementById("gallery-modal");const modalImg=document.getElementById("modal-img");const modalClose=document.querySelector(".modal-close");function openModal(src){modalImg.src=src;modal.classList.remove("hide");modal.style.display="flex";setTimeout(()=>{modal.classList.add("show");},20);}
function closeModal(){modal.classList.remove("show");modal.classList.add("hide");setTimeout(()=>{if(modal.classList.contains("hide")){modal.style.display="none";}},500);}
galleryItems.forEach((item)=>{const img=item.querySelector("img");img.addEventListener("click",()=>openModal(img.src));});modalClose.addEventListener("click",closeModal);modal.addEventListener("click",(e)=>{if(e.target===modal)closeModal();});let startY=0;let currentY=0;let isDragging=false;function onDragStart(e){isDragging=true;startY=e.touches?e.touches[0].clientY:e.clientY;}
function onDragMove(e){if(!isDragging)return;currentY=e.touches?e.touches[0].clientY:e.clientY;const deltaY=currentY-startY;if(deltaY<0){modalImg.style.transform=`translateY(${deltaY}px)`;if(e.touches)e.preventDefault();}}
function onDragEnd(e){if(!isDragging)return;isDragging=false;const deltaY=currentY-startY;modalImg.style.transform="";if(deltaY<-30){closeModal();}}
modalImg.addEventListener("touchstart",onDragStart,{passive:true});modalImg.addEventListener("touchmove",onDragMove,{passive:false});modalImg.addEventListener("touchend",onDragEnd);